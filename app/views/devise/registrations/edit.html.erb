<link href="http://getbootstrap.com/assets/css/docs.min.css" rel="stylesheet">
<link href="/assets/main.css" rel="stylesheet">
<!--Middle content starts here-->
<section id="midd-container">
  <!--new volunteer section-->
  <div class="user-prf-sec">
    <div class="fixed-wrapper">
      <div class="inbox">
        <div class="corner3"></div>
        <h1><%=t (:profile_setting)%></h1>
      </div>
      <div class="user-prf-row1">
        <div class="user-prf-left">
          <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
            <div class="vol-img-lft">
              <div class="photoSettings">
                <li>
                  <% if current_user.image_file_name.present? %><%= image_tag current_user.image.url, style: "height: 150px;width: 150px;" %>
                  <% else %> <%= image_tag 'no-img.jpg', style: "height: 150px;width: 150px;" %>
                  <% end %>
                  <%= f.file_field :image, value: "CHANGE AVATAR"  %>
                  <!--<button>CHANGE AVATAR</button>-->
                </li>
              </div>
            </div>
            <div class="user-prf-left-cont">
              <div class="nameSettings"> <%= f.text_field :first_name, :required => true, :placeholder => "First Name" %> </div>
              <br/>

              <div class="city"><%= f.text_field :city, :required => true, :placeholder => "City" %></div>
              <div class="state"><%= f.text_field :state, :required => true, :placeholder => "State" %></div>
              <br/>

              <div class="description">
                <%= f.text_area :description, :placeholder => "Description", :required => true %>
              </div>
              <input type="button" value="Reset" class="reset-btn">
              <%= f.submit "Save" %>
            </div>
          <% end %>
        </div>
        <div class="user-prf-rgt"><strong>Volunteered:</strong>

          <p><span>300</span> times</p>

          <p><span>1000</span> hours</p><br/>

          <p><span>2136</span> Supporters </p>
        </div>
        <div class="foundCreate">
          <button>CREATE YOUR<br/>FOUNDATION PROFILE</button>
        </div>
      </div>
      <div class="user-photos-row">
        <ul>
          <div class="photoSettings">
            <% if @user_pictures.present? %>
              <% picture = 4 - @user_pictures.size %>
              <% @user_pictures.each do |user_picture|%>
                <li>
                  <%= image_tag user_picture.image.url, style: "height: 130px;width: 100%;" %>
                  <%= button_to "CHANGE PHOTO", 'javascript:;', :class=> "change_user_image", :id=> "#{user_picture.id}" %>
                  <%= form_for user_picture, url: update_path, :html => {:class => 'user_images'}  do |f| %>
                    <%= f.hidden_field :user_picture_id, :value => user_picture.id %>
                    <br><%= f.file_field :image, :class=>"upload_image" %> <br>
                    <span><%= f.submit "Save", :class=>"save_user_image" %>
                    <%= button_to "Cancle", "javascript;;",:class=> "cancle_user_image" %></span>
                    </li>
                  <% end %>
              <% end %>
              <% 1.upto(picture) do |i| %>
                <li><img src="/assets/photoImg.jpg" alt="">
                  <%= button_to "CHANGE PHOTO", 'javascript:;', :class=>"change_user_new_image", :id => "#{i}" %>
                  <%= form_for @picture, url: update_path, :html => {:class => 'user_new_images', :id=> "new_user_picture_#{i}"}  do |f| %>
                    <br><%= f.file_field :image, :class=>"upload_new_image" %> <br>
                    <%= f.submit "Save", :class=>"save_new_user_image" %>
                    <%= button_to "Cancle", "javascript;;",:class=> "cancle_new_user_image" %>
                  <% end %>
                </li>
              <% end %>
            <% else %>
              <% 1.upto(4) do |i| %>
                <li><img src="/assets/photoImg.jpg" alt="">
                  <%= button_to "CHANGE PHOTO", 'javascript:;', :class=>"change_user_new_image", :id => "#{i}" %>
                  <%= form_for @picture, url: update_path, :html => {:class => 'user_new_images', :id=> "new_user_picture_#{i}"}  do |f| %>
                    <br><%= f.file_field :image, :class=>"upload_new_image" %> <br>
                    <%#= button_to "Cancel", 'javascript:;', :class=>"cancle_user_image" %>
                    <%= f.submit "Save", :class=>"save_new_user_image" %>
                    <%= button_to "Cancle", "javascript;;",:class=> "cancle_new_user_image" %>
                  <% end %>
                </li>
              <% end %>
            <% end %>
          </div>
        </ul>
      </div>
    </div>
  </div>
  <!--photo section ends-->
  <div class="volunteer-full float-full user-prf-vol">
    <div class="fixed-wrapper">
      <div id="volunteers">
        <div class="corner"></div>
        <h1><%=t (:my_supporters)%></h1><br/>

        <div class="volBox">
          <% if @user_supporters.present? %>
            <% @user_supporters.in_groups_of(3, false) do |user_support| %>
              <% for user in user_support %>
                <div class="supporters">
                  <% if user.friend.present? && user.friend.image.present? && user.friend != current_user %>
                    <%= image_tag user.friend.image.url(:medium), style: "height: 65px;" %>
                    <h2><%= link_to user.friend.last_name_initial.capitalize, user_profile_path(:id => user.friend.id) %></h2>
                    <%= button_to 'Remove', remove_friend_path(:friend_id => user.friend.id, :user_id => current_user.id), :method => :post, :class=>"remove-btn" %>
                  <% end %>
                </div>
              <% end %>
            <% end %>
          <% else %>
            <h2 align="center" style="margin: 100px;"><b><%= t(:no_supporter) %></b></h2>
          <% end %>
        </div>
      </div>
    </div>
    <!--mysupporters section ends-->

    <div class="volunteer-full float-full user-prf-vol">
      <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
        <div class="fixed-wrapper">
          <div id="settings">
            <div class="corner"></div>
            <h1><%=t (:privacy_setting)%></h1><br/>

            <div class="privacyQuestion-left">
              <h2>Permissions:</h2>

              <h2>Can everyone view your profile?</h2>

              <h2>Can everyone view your calendar?</h2>

              <h2>Can everyone invite you to events?</h2>

              <h2>Can everyone view your posts?</h2>

              <h2>Can everyone message you?</h2>

              <h2>Do volunteers need approval to join your gigs?</h2>

              <h2>Do supporters need approval to comment on your posts?</h2>
            </div>
            <div class="switch2">
              <div>
                <%= f.check_box :everyone_view_your_profile, :class => "form-control" %>
              </div>
              <div>
                <%= f.check_box :everyone_view_your_calendar, :class => "form-control" %>
              </div>
              <div>
                <%= f.check_box :everyone_invite_you_to_events, :class => "form-control" %>
              </div>
              <div>
                <%= f.check_box :everyone_view_your_post, :class => "form-control" %>
              </div>
              <div>
                <%= f.check_box :everyone_message_you, :class => "form-control" %>
              </div>
              <div>
                <%= f.check_box :volunteers_need_approval_join_your_gigs, :class => "form-control" %>
              </div>
              <div>
                <%= f.check_box :supporters_need_approval_to_comment, :class => "form-control" %>
              </div>
            </div>
            <div class="privacyQuestion">
              <h3>Change your password:</h3>
              <%#= f.fields_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put  }) do |ff| %>
              <%= devise_error_messages! %>
              <%= hidden_field_tag :reset_password_token %>
              <div class="passwordChange">
                <%= password_field_tag 'password', nil, :placeholder => "New Password" %>
                <%= password_field_tag 'password_confirmation', nil, :placeholder => "Confirm Password" %>
                <%= submit_tag "Save", :onclick => "return update_password();" %>
              </div>
              <%# end %>
            </div>
            <div class="notifications">
              <div class="notificationQuestion">
                <h2>Notifications:</h2>

                <div class="notificationSettings">
                  <%= f.email_field :email, :required => true, :placeholder => "Email" %>
                </div>
                <h2>Email Notifications?</h2>

                <div class="notificationSettings">
                  <%= f.text_field :phone_number, :maxlength => "10", :pattern => "[0-9]{10}", :placeholder => "Phone" %>
                </div>
                <h2>Text/SMS Notifications?</h2>

                <h2>Would you like mobile ping notifications?</h2>
              </div>

              <div class="switch3">
                <div>
                  <%= f.check_box :email_notification, :class => "form-control" %>
                </div>
                <div>
                  <%= f.check_box :sms_notification %>
                </div>
                <div>
                  <%= f.check_box :mobile_ping_notifications %>
                </div>
              </div>
            </div>
          </div>
          <div class="fixed-wrapper">
            <div class="saveSettings">
              <!--<input type="submit" value="Save Privacy Settings">-->
              <%= f.submit "Save Privacy Settings" %>
              <input type="button" value="Reset Privacy Settings" class="reset-privacy-setting-btn">
            </div>
          </div>
        </div>
      <% end %>
    </div>
</section>
<!--Middle content ends here-->
<script>
	$(function (argument) {
		$('[type="checkbox"]').bootstrapSwitch();
	})
	$('.reset-btn').click(function () {
		$("input[type=text], textarea").val("");
	});
	$('.reset-privacy-setting-btn').click(function () {
		$('#user_supporters_need_approval_to_comment').attr('checked', 'checked');
		$("#user_email").val(" ");
	});
	$(".change_user_image").click(function(){
		$("#edit_user_picture_"+this.id).show();
		$(this).toggle();
	});
	$(".change_user_new_image").click(function(){
		$("#new_user_picture_"+this.id).show();
		$(this).toggle();
	});
	function update_password() {
		if ($('#password').val() == '' || $('#password_confirmation').val() == '') {
			if ($('#password').val() != '' || $('#password_confirmation').val() != '')
				alert("Password & Confirm Password can't be blank");
		}
		else {
			if ($('#password').val() == $('#password_confirmation').val()) {
				$.ajax({
					type: 'post',
					url: '/registrations/update_password',
					data: {password: $('#password').val(), password_confirmation: $('#password_confirmation').val()}
				});
			}
			else {
				alert("Password & Confirm Password doesn't match");
			}
		}
		return false;
	}
	$('.cancle_user_image').click(function(){
		window.location.href='/users/edit';
		return false;
	})
	$('.cancle_new_user_image').click(function(){
		window.location.href='/users/edit';
		return false;
	})
</script>
<style>
	#error_explanation h2 {
		display: none;
	}
	.user_images {
		display: none;
	}
	.user_new_images {
		display: none;
	}
</style>
<script>
//	$('.save_user_image').click( function() {
//		//check whether browser fully supports all File API
//		if (window.File && window.FileReader && window.FileList && window.Blob)
//		{
//			//get the file size and file type from file input field
//			var fsize = $('#user_picture_image')[0].files[0].size;
//		}else{
//			alert("Please upgrade your browser, because your current browser lacks some new features we need!");
//		}
//	});
</script>